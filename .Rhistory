devtools::document()
UniPro(30, 3)
devtools::check()
remotes::install_github('oonyambu/egooptim')
install.packages('DiceOptim')
remotes::install_github('cran/DiceOptim')
remotes::install_github('oonyambu/egooptim')
20000*.06
20000*.6
2.61-3.2
.6*4000
reticulate::repl_python()
df<-structure(list(ID = 1:10, DOB = structure(c(-3704, -7119, -7375,
-8217, -8504, -4886, -6899, -3027, -5546, -4512), class = "Date"),
date1 = structure(c(7284, 9182, 4609, 6370, 5796, 9004, 8215,
5391, 8778, 6724), class = "Date"), date2 = structure(c(12429,
10203, 10764, 14487, 11367, 14495, 14845, 12190, 10216, 13144
), class = "Date"), age.date1 = c(30.0835044490075, 44.6297056810404,
32.8104038329911, 39.937029431896, 39.1512662559891, 38.0287474332649,
41.3798767967146, 23.047227926078, 39.2169746748802, 30.7624914442163
), age.date2 = c(44.1697467488022, 47.4250513347023, 49.6618754277892,
62.1601642710472, 54.403832991102, 53.0622861054073, 59.5318275154004,
41.6618754277892, 43.1540041067762, 48.3394934976044), age50day = structure(c(14559,
11144, 10887, 10046, 9759, 13376, 11364, 15235, 12717, 13750
), class = "Date"), expyrs.50 = c(NA_real_, NA_real_, NA_real_,
NA_real_, NA_real_, NA_real_, NA_real_, NA_real_, NA_real_,
NA_real_)), row.names = c(NA, 10L), class = "data.frame")
df
dfwant<-structure(list(ID = 1:10, DOB = structure(c(-3704, -7119, -7375,
-8217, -8504, -4886, -6899, -3027, -5546, -4512), class = "Date"),
date1 = structure(c(7284, 9182, 4609, 6370, 5796, 9004, 8215,
5391, 8778, 6724), class = "Date"), date2 = structure(c(12429,
10203, 10764, 14487, 11367, 14495, 14845, 12190, 10216, 13144
), class = "Date"), age.date1 = c(30.0835044490075, 44.6297056810404,
32.8104038329911, 39.937029431896, 39.1512662559891, 38.0287474332649,
41.3798767967146, 23.047227926078, 39.2169746748802, 30.7624914442163
), age.date2 = c(44.1697467488022, 47.4250513347023, 49.6618754277892,
62.1601642710472, 54.403832991102, 53.0622861054073, 59.5318275154004,
41.6618754277892, 43.1540041067762, 48.3394934976044), age20day = structure(c(3601,
186, -70, -912, -1199, 2419, 406, 4278, 1759, 2793), class = "Date"),
age30day = structure(c(7254, 3839, 3582, 2741, 2454, 6071,
4059, 7930, 5412, 6445), class = "Date"), age40day = structure(c(10906,
7491, 7235, 6393, 6106, 9724, 7711, 11583, 9064, 10098), class = "Date"),
age50day = structure(c(14559, 11144, 10887, 10046, 9759,
13376, 11364, 15235, 12717, 13750), class = "Date"), expyrs.20 = c(0,
0, 0, 0, 0, 0, 0, 0, 0, 0), expyrs.30 = c(0, 0, 0, 0, 0,
0, 0, 6.95140314852841, 0, 0), expyrs.40 = c(9.91649555099247,
0, 7.1895961670089, 0.0629705681040383, 0.848733744010951,
1.97125256673511, 0, 16.952772073922, 0.783025325119781,
9.23750855578371), expyrs.50 = c(14.0862422997947, 2.79534565366188,
16.8514715947981, 10.0643394934976, 10.8501026694045, 11.9698836413415,
8.62149212867899, 18.6146475017112, 3.93702943189596, 17.5770020533881
)), row.names = c(NA, 10L), class = "data.frame")
df
dfwant
library(tidyverse)
yr
df
yr <- 20
df %>%
mutate(case_when(age.date1<=yr & age.date2<=yr ~
as.duration(date1 %--% date2)/dyears(1),
age.date1 <= yr & age.date2 > yr ~
as.duration(date1 %--% get(sprintf("age%dday", yr)))/dyears(1),
age.date1 > yr ~ 0))
df %>%
mutate(
"age{{yr}}day":= DOB %m+% years(20),
case_when(age.date1<=yr & age.date2<=yr ~
as.duration(date1 %--% date2)/dyears(1),
age.date1 <= yr & age.date2 > yr ~
as.duration(date1 %--% get(sprintf("age%dday", yr)))/dyears(1),
age.date1 > yr ~ 0))
df %>%
mutate(
"age{{yr}}day":= DOB %m+% years(yr),
case_when(age.date1<=yr & age.date2<=yr ~
as.duration(date1 %--% date2)/dyears(1),
age.date1 <= yr & age.date2 > yr ~
as.duration(date1 %--% get(sprintf("age%dday", yr)))/dyears(1),
age.date1 > yr ~ 0))
df %>%
mutate(
"age{{yr}}day":= DOB %m+% years(yr),
"expyrs{{yr}}" := case_when(age.date1<=yr & age.date2<=yr ~
as.duration(date1 %--% date2)/dyears(1),
age.date1 <= yr & age.date2 > yr ~
as.duration(date1 %--% get(sprintf("age%dday", yr)))/dyears(1),
age.date1 > yr ~ 0))
dfwant
yr <- 30
df %>%
mutate(
"age{{yr}}day":= DOB %m+% years(yr),
"expyrs{{yr}}" := case_when(age.date1<=yr & age.date2<=yr ~
as.duration(date1 %--% date2)/dyears(1),
age.date1 <= yr & age.date2 > yr ~
as.duration(date1 %--% get(sprintf("age%dday", yr)))/dyears(1),
age.date1 > yr ~ 0))
yr <- 50
df %>%
mutate(
"age{{yr}}day":= DOB %m+% years(yr),
"expyrs{{yr}}" := case_when(age.date1<=yr & age.date2<=yr ~
as.duration(date1 %--% date2)/dyears(1),
age.date1 <= yr & age.date2 > yr ~
as.duration(date1 %--% get(sprintf("age%dday", yr)))/dyears(1),
age.date1 > yr ~ 0))
yr <- 20
df %>%
mutate(
"age{{yr}}day":= DOB %m+% years(yr),
"expyrs{{yr}}" := case_when(age.date1<=yr & age.date2<=yr ~
as.duration(date1 %--% date2)/dyears(1),
age.date1 <= yr & age.date2 > yr ~
as.duration(date1 %--% get(sprintf("age%dday", yr)))/dyears(1),
age.date1 > yr ~ 0))
df
df[-ncol(df)]
df<-df[-ncol(df)]
yr <- 20
df %>%
mutate(
"age{{yr}}day":= DOB %m+% years(yr),
"expyrs{{yr}}" := case_when(age.date1<=yr & age.date2<=yr ~
as.duration(date1 %--% date2)/dyears(1),
age.date1 <= yr & age.date2 > yr ~
as.duration(date1 %--% get(sprintf("age%dday", yr)))/dyears(1),
age.date1 > yr ~ 0))
fn <- function(yr){
lst("age{{yr}}day":= DOB %m+% years(yr),
"expyrs{{yr}}" := case_when(age.date1<=yr & age.date2<=yr ~
as.duration(date1 %--% date2)/dyears(1),
age.date1 <= yr & age.date2 > yr ~
as.duration(date1 %--% get(sprintf("age%dday", yr)))/dyears(1),
age.date1 > yr ~ 0))
}
fn(20)
df %>%
mutate(fn(yr))
with(df,fn(yr))
df %>%
mutate(across(yr, fn))
df
df %>%
mutate(
"age{{yr}}day":= DOB %m+% years(yr),
"expyrs{{yr}}" := case_when(age.date1<=yr & age.date2<=yr ~
as.duration(date1 %--% date2)/dyears(1),
age.date1 <= yr & age.date2 > yr ~
as.duration(date1 %--% get(sprintf("age%dday", yr)))/dyears(1),
age.date1 > yr ~ 0))
map(c(20, 30, 40) ~\(yr)
df %>%
mutate(
"age{{yr}}day":= DOB %m+% years(yr),
"expyrs{{yr}}" := case_when(age.date1<=yr & age.date2<=yr ~
as.duration(date1 %--% date2)/dyears(1),
age.date1 <= yr & age.date2 > yr ~
as.duration(date1 %--% get(sprintf("age%dday", yr)))/dyears(1),
age.date1 > yr ~ 0))
)
map(c(20, 30, 40), ~\(yr)df %>%
mutate(
"age{{yr}}day":= DOB %m+% years(yr),
"expyrs{{yr}}" := case_when(age.date1<=yr & age.date2<=yr ~
as.duration(date1 %--% date2)/dyears(1),
age.date1 <= yr & age.date2 > yr ~
as.duration(date1 %--% get(sprintf("age%dday", yr)))/dyears(1),
age.date1 > yr ~ 0))
)
map(c(20, 30, 40), \(yr)df %>%
mutate(
"age{{yr}}day":= DOB %m+% years(yr),
"expyrs{{yr}}" := case_when(age.date1<=yr & age.date2<=yr ~
as.duration(date1 %--% date2)/dyears(1),
age.date1 <= yr & age.date2 > yr ~
as.duration(date1 %--% get(sprintf("age%dday", yr)))/dyears(1),
age.date1 > yr ~ 0))
)
map(c(20, 30, 40), \(yr)df %>%
mutate(
"age{{yr}}day":= DOB %m+% years(yr),
"expyrs{{yr}}" := case_when(age.date1<=yr & age.date2<=yr ~
as.duration(date1 %--% date2)/dyears(1),
age.date1 <= yr & age.date2 > yr ~
as.duration(date1 %--% get(sprintf("age%dday", yr)))/dyears(1),
age.date1 > yr ~ 0),.keep='used')
)
map(c(20, 30, 40), \(yr)df %>%
mutate(
"age{{yr}}day":= DOB %m+% years(yr),
"expyrs{{yr}}" := case_when(age.date1<=yr & age.date2<=yr ~
as.duration(date1 %--% date2)/dyears(1),
age.date1 <= yr & age.date2 > yr ~
as.duration(date1 %--% get(sprintf("age%dday", yr)))/dyears(1),
age.date1 > yr ~ 0),.keep='unsed')
)
map(c(20, 30, 40), \(yr)df %>%
mutate(
"age{{yr}}day":= DOB %m+% years(yr),
"expyrs{{yr}}" := case_when(age.date1<=yr & age.date2<=yr ~
as.duration(date1 %--% date2)/dyears(1),
age.date1 <= yr & age.date2 > yr ~
as.duration(date1 %--% get(sprintf("age%dday", yr)))/dyears(1),
age.date1 > yr ~ 0),.keep='none')
)
map(c(20, 30, 40), \(yr)df %>%
mutate(
"age{{yr}}day":= DOB %m+% years(yr),
"expyrs{{yr}}" := case_when(age.date1<=yr & age.date2<=yr ~
as.duration(date1 %--% date2)/dyears(1),
age.date1 <= yr & age.date2 > yr ~
as.duration(date1 %--% get(sprintf("age%dday", yr)))/dyears(1),
age.date1 > yr ~ 0),.keep='none')
)%>%
list_cbind()
map(c(20, 30, 40), \(yr)df %>%
mutate(
"age{{yr}}day":= DOB %m+% years(yr),
"expyrs{{yr}}" := case_when(age.date1<=yr & age.date2<=yr ~
as.duration(date1 %--% date2)/dyears(1),
age.date1 <= yr & age.date2 > yr ~
as.duration(date1 %--% get(sprintf("age%dday", yr)))/dyears(1),
age.date1 > yr ~ 0),.keep='none')
)%>%
list_cbind() %>%
bind_cols(df)
map(c(20, 30, 40), \(yr)df %>%
mutate(
"age{{yr}}day":= DOB %m+% years(yr),
"expyrs{{yr}}" := case_when(age.date1<=yr & age.date2<=yr ~
as.duration(date1 %--% date2)/dyears(1),
age.date1 <= yr & age.date2 > yr ~
as.duration(date1 %--% get(sprintf("age%dday", yr)))/dyears(1),
age.date1 > yr ~ 0),.keep='none')
)%>%
list_cbind() %>%
bind_cols(df, .)
df
df<-df[-ncol(df)]
df
map(c(20, 30, 40), \(yr)df %>%
mutate(
"age{{yr}}day":= DOB %m+% years(yr),
"expyrs{{yr}}" := case_when(age.date1<=yr & age.date2<=yr ~
as.duration(date1 %--% date2)/dyears(1),
age.date1 <= yr & age.date2 > yr ~
as.duration(date1 %--% get(sprintf("age%dday", yr)))/dyears(1),
age.date1 > yr ~ 0),.keep='none')
)%>%
list_cbind() %>%
bind_cols(df, .)
map(c(20, 30, 40, 50), \(yr)df %>%
mutate(
"age{{yr}}day":= DOB %m+% years(yr),
"expyrs{{yr}}" := case_when(age.date1<=yr & age.date2<=yr ~
as.duration(date1 %--% date2)/dyears(1),
age.date1 <= yr & age.date2 > yr ~
as.duration(date1 %--% get(sprintf("age%dday", yr)))/dyears(1),
age.date1 > yr ~ 0),.keep='none')
)%>%
list_cbind() %>%
bind_cols(df, .)
map(c(20, 30, 40, 50), \(yr)df %>%
mutate(
"age{{yr}}day":= DOB %m+% years(yr),
"expyrs{{yr}}" := case_when(age.date1<=yr & age.date2<=yr ~
as.duration(date1 %--% date2)/dyears(1),
age.date1 <= yr & age.date2 > yr ~
as.duration(date1 %--% get(sprintf("age%dday", yr), pick(everything())))/dyears(1),
age.date1 > yr ~ 0),.keep='none')
)%>%
list_cbind() %>%
bind_cols(df, .)
map(c(20, 30, 40, 50), ~df %>%
mutate(
"age{{.x}}day":= DOB %m+% years(.x),
"expyrs{{.x}}" := case_when(age.date1<=yr & age.date2 <= .x ~
as.duration(date1 %--% date2)/dyears(1),
age.date1 <= .x & age.date2 > .x ~
as.duration(date1 %--% get(sprintf("age%dday", .x),
pick(everything())))/dyears(1),
age.date1 > .x ~ 0),.keep='none')
)%>%
list_cbind() %>%
bind_cols(df, .)
map(c(20, 30, 40, 50), ~df %>%
mutate(
"age{{.x}}day":= DOB %m+% years(.x),
"expyrs{{.x}}" := case_when(age.date1<=yr & age.date2 <= .x ~
as.duration(date1 %--% date2)/dyears(1),
age.date1 <= .x & age.date2 > .x ~
as.duration(date1 %--% get(sprintf("age%dday", .x),
pick(everything())))/dyears(1),
age.date1 > .x ~ 0),.keep='none')
)%>%
list_cbind() %>%
bind_cols(df, .)
map(c(20, 30, 40, 50), ~df %>%
mutate(
"age{{.x}}day":= DOB %m+% years(.x),
"expyrs{{.x}}" := case_when(age.date1<=yr & age.date2 <= .x ~
as.duration(date1 %--% date2)/dyears(1),
age.date1 <= .x & age.date2 > .x ~
as.duration(date1 %--% get(sprintf("age%dday", .x),
pick(everything())))/dyears(1),
age.date1 > .x ~ 0),.keep='none')
)%>%
list_cbind() %>%
bind_cols(df, .)
rm(yr)
map(c(20, 30, 40, 50), ~df %>%
mutate(
"age{{.x}}day":= DOB %m+% years(.x),
"expyrs{{.x}}" := case_when(age.date1<=yr & age.date2 <= .x ~
as.duration(date1 %--% date2)/dyears(1),
age.date1 <= .x & age.date2 > .x ~
as.duration(date1 %--% get(sprintf("age%dday", .x),
pick(everything())))/dyears(1),
age.date1 > .x ~ 0),.keep='none')
)%>%
list_cbind() %>%
bind_cols(df, .)
map(c(20, 30, 40, 50), ~df %>%
mutate(
"age{{.x}}day":= DOB %m+% years(.x),
"expyrs{{.x}}" := case_when(age.date1<=.x & age.date2 <= .x ~
as.duration(date1 %--% date2)/dyears(1),
age.date1 <= .x & age.date2 > .x ~
as.duration(date1 %--% get(sprintf("age%dday", .x),
pick(everything())))/dyears(1),
age.date1 > .x ~ 0),.keep='none')
)%>%
list_cbind() %>%
bind_cols(df, .)
fn <- function(yr){
col1 <-  DOB %m+% years(yr),
fn <- function(yr){
col1 <-  DOB %m+% years(yr),
fn <- function(yr){
col1 <-  DOB %m+% years(yr)
col2 <-  case_when(age.date1 <= yr & age.date2<=yr ~
as.duration(date1 %--% date2)/dyears(1),
age.date1 <= yr & age.date2 > yr ~
as.duration(date1 %--% col1)/dyears(1),
age.date1 > yr ~ 0)
setNames(data.frame(col1, col2), paste0(c("age", "expyrs"), yr, c("day", "")))
}
fn <- function(yr){
col1 <-  DOB %m+% years(yr)
col2 <-  with(df, case_when(age.date1 <= yr & age.date2<=yr ~
as.duration(date1 %--% date2)/dyears(1),
age.date1 <= yr & age.date2 > yr ~
as.duration(date1 %--% col1)/dyears(1),
age.date1 > yr ~ 0))
setNames(data.frame(col1, col2), paste0(c("age", "expyrs"), yr, c("day", "")))
}
fn(20)
fn <- function(yr){
col1 <-  df$DOB %m+% years(yr)
col2 <-  with(df, case_when(age.date1 <= yr & age.date2<=yr ~
as.duration(date1 %--% date2)/dyears(1),
age.date1 <= yr & age.date2 > yr ~
as.duration(date1 %--% col1)/dyears(1),
age.date1 > yr ~ 0))
setNames(data.frame(col1, col2), paste0(c("age", "expyrs"), yr, c("day", "")))
}
fn(20)
fn(50)
sapply(c(20,30,40,50))
sapply(c(20,30,40,50), fn)
lapply(c(20,30,40,50), fn)
map(c(20,30,40,50), fn)
map(c(20,30,40,50), fn)%>% bind_rows()
map(c(20,30,40,50), fn)%>% bind_cols()
map(c(20,30,40,50), fn)%>% list_cols()
map(c(20,30,40,50), fn)%>% list_col()
map(c(20,30,40,50), fn)%>% list_cbind()
map(c(20,30,40,50), fn)%>% bind_cols()
map(c(20,30,40,50), fn)%>% bind_cols(df, .)
sample(50, 4, T)
sample(4, 50, T)
set.seed(5)
a<-sample(4, 50, T)
diag(4)[a,]
b<-diag(4)[a,]
b+ rnorm(50*4)
b+ runif(50*4)
b
b <- diag(4)[a,]+ runif(50*4)
b
b <- proportions(diag(4)[a,]+ runif(50*4), 1)
set.seed(5)
a<-sample(4, 50, T)
b <- proportions(diag(4)[a,]+ runif(50*4), 1)
b
b <- proportions(diag(4)[a,]+ runif(50*4, 0, 0.1), 1)
b
beta <- cbind(c(-1,-2,1,0), 1)
beta
X <- cbind(1, 10)
beta%*% X
X
X <- cbind(1, c(10, 20, 30, 40))
X
crossprod(X, beta)
X
beta
apply(beta, 1, \(i) i%*%X)
apply(beta, 1, \(i) X%*%i)
X
X <- cbind(1, c(10, 20, 30, 40, 0))
crossprod(X, beta)
apply(beta, 1, \(i) X%*%i)
X <- cbind(1, c(10, 20, 30, 40, -10))
#crossprod(X, beta)
apply(beta, 1, \(i) X%*%i)
beta
seq(1,1020)
seq(1,100, 2)
seq(1,100, 2)|>cumsum()
seq(1,100, 2)|>cumsum()|>sqrt()
devtools::document()
UniPro(30, 3)
UniPro(30, 3, 100, 1500, 0.2, 0.3, 0.95)
UniPro(30, 3, 50, 1500, 0.2, 0.3, 0.95)
UniPro(30, 3, 150, 1500, 0.2, 0.3, 0.95)
UniPro(30, 3, 150, 1500, 0.2, 0.3, 0.95, trace = 3)
UniPro(30, 3, 150, 1500, 0.2, 0.3, 0.95, trace = 3)->a
a$measure
devtools::document()
UniPro(30, 3, 150, 1500, 0.2, 0.3, 0.95, trace = 3)
UniPro(30, 3, NP = 150, itermax = 1500, pMut = 0.2, pCR = 0.3, pGBest = 0.95, trace = 3)
devtools::document()
UniPro(30, 3, NP = 150, itermax = 1500, pMut = 0.2, pCR = 0.3, pGBest = 0.95, trace = 3)
UniPro(30, 3, NP = 150, itermax = 1500, pMut = 0.2, pCR = 0.3, pGBest = 0.95)
UniPro(30, 3)
UniPro(30, 3, NP = 150, itermax = 1500, pMut = 0.2, pCR = 0.3, pGBest = 0.95)
devtools::document()
UniPro(30, 3, NP = 150, itermax = 1500, pMut = 0.2, pCR = 0.3, pGBest = 0.95)
UniPro(30, 3)
UniPro(30, 3, pMut = 0.1, pCR = 0.9)
UniPro(30, 3, pMut = 0.9, pCR = 0.9)
UniPro(50, 5, pMut = 0.9, pCR = 0.9)
UniPro(70, 7, pMut = 0.9, pCR = 0.9)
UniPro(70, 7, pMut = 0.9, pCR = 0.9, replicates = 10)
UniPro(70, 7, replicates = 10)
UniPro(70, 7, replicates = 10)->a
a$measure
devtools::document()
UniPro(70, 7, replicates = 10)->a
a$measure
UniPro(70, 7, replicates = 10)->a
devtools::document()
UniPro(70, 7, replicates = 10)->a
a$measure
devtools::document()
UniPro(70, 7, replicates = 10, trace = 2)->a
a$measure
devtools::document()
UniPro(70, 7, replicates = 10, trace = 2)->a
devtools::document()
UniPro(70, 7, replicates = 10, trace = 2)->a
devtools::document()
remove.packages('UniPro')
devtools::document()
UniPro(70, 7, replicates = 10, trace = 2)
devtools::document()
UniPro(70, 7, replicates = 10, trace = 2)->A
